<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.14.7" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42099,7635284607" ReportOptions.Description.Text="" ReportOptions.LastChange="42175,5725179745" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403980003546F700308020844617461736574730101062C20446174615365743D2241444F5175657279312220446174615365744E616D653D2241444F517565727931220000095661726961626C65730101060F204E616D653D22204172436F6D70220001063C204E616D653D2254555F4944222056616C75653D222738303334464544312D463146392D343333362D423832432D46434641464539443130394527220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADOQuery Name="ADOQuery1" UserName="ADOQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SET NOCOUNT ON                              &#13;&#10;&#13;&#10;DECLARE @TU_ID varchar(36)&#13;&#10;&#13;&#10;SET @TU_ID = :TU_ID          &#13;&#10;&#13;&#10;&#13;&#10;DECLARE @personenProScheibe integer&#13;&#10;&#13;&#10;SET @personenProScheibe = (SELECT TU_PERSONEN_PRO_SCHEIBE FROM TURNIER WHERE TU_ID = @TU_ID)&#13;&#10;&#13;&#10;CREATE TABLE #tmp(&#13;&#10;  BK_NAME varchar(50),&#13;&#10;  AK_NAME varchar(50),&#13;&#10;  GE_NAME varchar(50),&#13;&#10;  DI_DISTANZ integer,&#13;&#10;  DI_AUFLAGE varchar(50),&#13;&#10;  ANZAHL integer&#13;&#10;)&#13;&#10;&#13;&#10;INSERT INTO #tmp(&#13;&#10;  BK_NAME,&#13;&#10;  AK_NAME,&#13;&#10;  GE_NAME,&#13;&#10;  DI_DISTANZ,&#13;&#10;  DI_AUFLAGE,&#13;&#10;  ANZAHL  &#13;&#10;)&#13;&#10;SELECT&#13;&#10;  bk.BK_NAME,&#13;&#10;  ak.AK_NAME,&#13;&#10;  ge.GE_NAME,&#13;&#10;  di.DI_DISTANZ,&#13;&#10;  di.DI_AUFLAGE,&#13;&#10;  0&#13;&#10;FROM TURNIER tu&#13;&#10;  INNER JOIN DISTANZ di&#13;&#10;    ON tu.TA_ID = di.TA_ID&#13;&#10;  INNER JOIN BOGENKATEGORIE bk&#13;&#10;    ON di.BK_ID = bk.BK_ID&#13;&#10;  INNER JOIN ALTERSKATEGORIE ak&#13;&#10;    ON di.AK_ID = ak.AK_ID&#13;&#10;  INNER JOIN GESCHLECHT ge&#13;&#10;    ON di.GE_ID = ge.GE_ID&#13;&#10;WHERE tu.TU_ID = @TU_ID&#13;&#10;  AND di.DI_RUNDE = 1&#13;&#10;ORDER BY &#13;&#10;  DI_DISTANZ,&#13;&#10;  BK_NAME,&#13;&#10;  AK_NAME,&#13;&#10;  GE_NAME&#13;&#10;&#13;&#10;&#13;&#10;UPDATE tmp&#13;&#10;SET ANZAHL = tmp.ANZAHL + teilnehmer.ANZAHL&#13;&#10;FROM #tmp tmp&#13;&#10;  INNER JOIN (&#13;&#10;    SELECT&#13;&#10;      pe.PE_BOGENKATEGORIE,&#13;&#10;      pe.PE_ALTERSKLASSE,&#13;&#10;      pe.PE_GESCHLECHT,&#13;&#10;      COUNT(*) AS ANZAHL&#13;&#10;    FROM TURNIER tu&#13;&#10;      INNER JOIN TURNIER_ZUTEILUNG tz&#13;&#10;        ON tu.TU_ID = tz.TU_ID&#13;&#10;      INNER JOIN PERSON pe&#13;&#10;        ON tz.PE_ID = pe.PE_ID&#13;&#10;    WHERE tu.TU_ID = @TU_ID&#13;&#10;    GROUP BY&#13;&#10;      pe.PE_BOGENKATEGORIE,&#13;&#10;      pe.PE_ALTERSKLASSE,&#13;&#10;      pe.PE_GESCHLECHT&#13;&#10;   ) teilnehmer&#13;&#10;     ON tmp.BK_NAME = teilnehmer.PE_BOGENKATEGORIE&#13;&#10;	   AND tmp.AK_NAME = teilnehmer.PE_ALTERSKLASSE&#13;&#10;	   AND tmp.GE_NAME = teilnehmer.PE_GESCHLECHT&#13;&#10;&#13;&#10;&#13;&#10;SET NOCOUNT OFF                                       &#13;&#10;&#13;&#10;  SELECT&#13;&#10;    DI_DISTANZ,&#13;&#10;	DI_AUFLAGE,&#13;&#10;	SUM(ANZAHL) AS ANZAHL_SCHUETZEN,&#13;&#10;	CEILING(CAST(SUM(ANZAHL)AS decimal(18,2))/@personenProScheibe) ANZAHL_SCHEIBEN&#13;&#10;  FROM #tmp&#13;&#10;  WHERE ANZAHL &#62; 0&#13;&#10;  GROUP BY DI_DISTANZ, DI_AUFLAGE&#13;&#10;  ORDER BY DI_DISTANZ DESC&#13;&#10;&#13;&#10;&#13;&#10;  DROP TABLE #tmp    " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C6566740398000470546F7002640A506172616D65746572730101063E204E616D653D2254555F4944222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B54555F4944262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="22,67718" Left="0" Top="16" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="ADOQuery1" DataSetName="ADOQuery1" RowCount="0">
      <TfrxMemoView Name="Memo2" Left="7,55906" Top="0" Width="94,48825" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="Distanz"/>
      <TfrxMemoView Name="Memo3" Left="107,60637" Top="0" Width="196,53556" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Auflage"/>
      <TfrxMemoView Name="Memo5" Left="309,92146" Top="0" Width="128,50402" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="Anzahl SchÃ¼tzen"/>
      <TfrxMemoView Name="Memo7" Left="442,20501" Top="0" Width="128,50402" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="Anzahl Scheiben"/>
    </TfrxMasterData>
    <TfrxDetailData Name="DetailData1" Height="22,67718" Left="0" Top="60" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="ADOQuery1" DataSetName="ADOQuery1" RowCount="0">
      <TfrxMemoView Name="Memo1" Left="7,55906" Top="0" Width="94,48825" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[ADOQuery1.&#34;DI_DISTANZ&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="107,60637" Top="0" Width="196,53556" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[ADOQuery1.&#34;DI_AUFLAGE&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="309,92146" Top="0" Width="128,50402" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[ADOQuery1.&#34;ANZAHL_SCHUETZEN&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="442,20501" Top="0" Width="128,50402" Height="18,89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[ADOQuery1.&#34;ANZAHL_SCHEIBEN&#34;]"/>
    </TfrxDetailData>
  </TfrxReportPage>
</TfrxReport>
